<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OshanCart Signup/Login</title>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- CSS -->
<style>
/* Body & Background */
body {
    margin:0;
    font-family: Arial, sans-serif;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background-size: cover;
    background-position: center;
}

/* Drag & Drop upload box */
.upload-box {
    position: absolute;
    top:20px;
    left:50%;
    transform: translateX(-50%);
    width: 300px;
    height: 100px;
    border: 2px dashed #c9184a;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    background: rgba(255,255,255,0.2);
    text-align:center;
    z-index: 10;
}
.upload-box p { margin:5px 0 0; color:#fff; font-weight:bold; }

/* Auth Card */
.auth-card {
    background: rgba(255, 165, 0, 0.95); /* Orange Theme */
    padding: 30px;
    border-radius: 12px;
    width: 350px;
    text-align: center;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 5;
    position: relative;
}

/* Buttons */
.auth-btn {
    display:block;
    width:100%;
    padding: 12px;
    margin:10px 0;
    border:none;
    border-radius:5px;
    cursor:pointer;
    font-size:16px;
}

.google {background:#db4437;color:#fff;}
.facebook {background:#4267B2;color:#fff;}
.email {background:#fff;color:#ff7f00; border:1px solid #ff7f00;}

/* Popup */
.popup {
    position: fixed;
    display: none;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.6);
    justify-content: center;
    align-items: center;
    z-index: 9999;
}
.popup-content {
    background:#fff;
    padding: 20px;
    border-radius: 12px;
    text-align:center;
    position: relative;
}
.close {
    position:absolute;
    top:10px; right:15px;
    font-size:24px;
    cursor:pointer;
}

/* Logo */
.logo { width:100px; margin-bottom:15px; }

/* Responsive */
@media(max-width:480px){
    .auth-card { width:90%; padding:20px; }
    .upload-box { width:80%; height:80px; }
}
</style>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
</head>
<body>

<!-- Drag & Drop / Click Upload -->
<div class="upload-box" id="drop-zone">
    <i class="fas fa-images" style="font-size: 30px; color: #c9184a;"></i>
    <p id="upload-status">Drag & Drop / Click to Upload Background</p>
    <input type="file" id="p-file" accept="image/*" style="display: none;">
</div>

<!-- Offer Popup -->
<div id="offerPopup" class="popup">
  <div class="popup-content">
    <span id="closePopup" class="close">&times;</span>
    <img src="images/offer1.png" alt="50% OFF" style="width:80px; margin-bottom:10px;">
    <h2>SUPER SALE</h2>
    <p>Big offers today! Don't miss out!</p>
  </div>
</div>

<!-- Signup/Login Card -->
<div class="auth-card">
    <img src="images/logo.png" alt="OshanCart Logo" class="logo">
    <h1>Welcome to OshanCart</h1>
    
    <button id="googleSignIn" class="auth-btn google">Continue with Google</button>
    <button id="fbSignIn" class="auth-btn facebook">Continue with Facebook</button>
    
    <form id="emailForm">
        <input type="email" placeholder="Email" required id="email">
        <input type="password" placeholder="Password" required id="password">
        <button type="submit" class="auth-btn email">Continue with Email</button>
    </form>
</div>

<!-- Firebase Config + JS -->
<script>
const firebaseConfig = {
    apiKey: "AIzaSyDy430AP0t92QND_VdaoCkK0J23y2c5rkE",
    authDomain: "oshancart.firebaseapp.com",
    projectId: "oshancart",
    storageBucket: "oshancart.appspot.com",
    messagingSenderId: "686982543488",
    appId: "1:686982543488:web:d74a83a3f53dbae3754e65"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

// ----- Offer Popup -----
const popup = document.getElementById('offerPopup');
const closeBtn = document.getElementById('closePopup');

window.onload = () => {
    if(!localStorage.getItem('offerShown')){
        popup.style.display = 'flex';
        localStorage.setItem('offerShown','true');
    }
};
closeBtn.onclick = () => popup.style.display = 'none';

// ----- Background Drag & Drop -----
const dropZone = document.getElementById('drop-zone');
const pFile = document.getElementById('p-file');

dropZone.addEventListener('click', () => pFile.click());
pFile.addEventListener('change', e => {
    const file = e.target.files[0];
    if(file){
        const reader = new FileReader();
        reader.onload = evt => {
            document.body.style.backgroundImage = `url('${evt.target.result}')`;
        }
        reader.readAsDataURL(file);
    }
});
dropZone.addEventListener('dragover', e => e.preventDefault());
dropZone.addEventListener('drop', e => {
    e.preventDefault();
    const file = e.dataTransfer.files[0];
    if(file){
        const reader = new FileReader();
        reader.onload = evt => {
            document.body.style.backgroundImage = `url('${evt.target.result}')`;
        }
        reader.readAsDataURL(file);
    }
});

// ----- Firebase Auth -----

// Google Sign-In
document.getElementById('googleSignIn').addEventListener('click', () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider)
    .then(res => alert('Google Sign-In Success! Welcome '+ res.user.displayName))
    .catch(err => alert(err.message));
});

// Facebook Sign-In
document.getElementById('fbSignIn').addEventListener('click', () => {
    const provider = new firebase.auth.FacebookAuthProvider();
    auth.signInWithPopup(provider)
    .then(res => alert('Facebook Sign-In Success! Welcome '+ res.user.displayName))
    .catch(err => alert(err.message));
});

// Email Sign-In / Sign-Up
document.getElementById('emailForm').addEventListener('submit', e => {
    e.preventDefault();
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;

    auth.createUserWithEmailAndPassword(email, password)
    .then(res => alert('Signup Success! Welcome '+ res.user.email))
    .catch(err => {
        if(err.code === 'auth/email-already-in-use'){
            auth.signInWithEmailAndPassword(email,password)
            .then(res => alert('Login Success! Welcome '+ res.user.email))
            .catch(e => alert(e.message));
        } else alert(err.message);
    });
});
</script>

</body>
</html>
