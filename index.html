<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oshan Cart | Global Super Shopping Hub</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.0.2/css/flag-icons.min.css"/>

    <style>
        :root {
            --primary: #c9184a;
            --amazon-blue: #131921;
            --nav-bg: #232f3e;
            --orange: #febd69;
            --white: #ffffff;
            --light-grey: #f3f3f3;
        }

        body { 
            font-family: 'Poppins', sans-serif; 
            margin: 0; 
            background: var(--light-grey); 
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* ==========================================
           DESKTOP STYLES (Hide on Mobile)
        ========================================== */
        @media screen and (min-width: 1024px) {
            .mobile-only { display: none !important; }
            
            nav {
                background: var(--amazon-blue);
                padding: 10px 2%;
                display: flex;
                align-items: center;
                justify-content: space-between;
                position: sticky;
                top: 0;
                z-index: 2000;
            }

            .search-container {
                flex: 1;
                display: flex;
                max-width: 800px;
                margin: 0 20px;
                background: white;
                border-radius: 6px;
                height: 40px;
                overflow: hidden;
            }

            .cat-dropdown { position: relative; height: 100%; }
            .cat-btn {
                background: #f3f3f3;
                border: none;
                height: 100%;
                padding: 0 15px;
                cursor: pointer;
                font-size: 13px;
                display: flex;
                align-items: center;
                gap: 5px;
            }
            
            .search-bar { flex: 1; display: flex; align-items: center; }
            .search-bar input { width: 100%; border: none; padding: 10px; outline: none; font-size: 14px; }
            .search-submit { background: var(--orange); border: none; width: 50px; height: 100%; cursor: pointer; font-size: 18px; }

            .nav-right { display: flex; align-items: center; gap: 25px; color: white; }
            
            /* Admin & User Menus Dropdown Styling */
            .dropdown { position: relative; cursor: pointer; }
            .dropdown-content {
                display: none;
                position: absolute;
                top: 100%;
                right: 0;
                background: white;
                min-width: 250px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                border-radius: 8px;
                padding: 15px 0;
                z-index: 3000;
            }
            .dropdown:hover .dropdown-content { display: block; }
            .dropdown-content a {
                color: #333;
                padding: 12px 20px;
                text-decoration: none;
                display: flex;
                align-items: center;
                gap: 10px;
                font-size: 14px;
            }
            .dropdown-content a:hover { background: #f0f2f2; color: var(--primary); }
        }

        /* ==========================================
           MOBILE STYLES (App-like Interface)
        ========================================== */
        @media screen and (max-width: 1023px) {
            .desktop-only { display: none !important; }

            /* Mobile Header */
            .mobile-header {
                background: var(--amazon-blue);
                padding: 10px 15px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                position: sticky;
                top: 0;
                z-index: 2000;
            }

            .mobile-search-box {
                background: white;
                margin: 0 10px;
                border-radius: 20px;
                padding: 8px 15px;
                display: flex;
                align-items: center;
                flex: 1;
            }
            .mobile-search-box input { border: none; outline: none; width: 100%; margin-left: 10px; }

            /* Side Sidebar Menu */
            .sidebar {
                position: fixed;
                left: -100%;
                top: 0;
                width: 80%;
                height: 100%;
                background: white;
                z-index: 4000;
                transition: 0.4s;
                overflow-y: auto;
            }
            .sidebar.active { left: 0; }
            .sidebar-overlay {
                position: fixed;
                display: none;
                top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 3999;
            }

            /* Bottom App Bar */
            .bottom-nav {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                background: white;
                display: flex;
                justify-content: space-around;
                padding: 10px 0;
                box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
                z-index: 3000;
            }
            .bottom-nav-item {
                text-align: center;
                color: #555;
                text-decoration: none;
                font-size: 11px;
            }
            .bottom-nav-item i { font-size: 20px; display: block; margin-bottom: 2px; }
            .bottom-nav-item.active { color: var(--primary); }
        }

        /* ==========================================
           COMMON UI ELEMENTS
        ========================================== */
        /* AI Assistant Floating Button */
        .ai-btn {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #c9184a, #ff4d6d);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 30px;
            box-shadow: 0 5px 15px rgba(201, 24, 74, 0.4);
            cursor: pointer;
            z-index: 3500;
            animation: bounce 2s infinite;
        }

        /* AI Chat Box */
        .ai-chat-box {
            position: fixed;
            bottom: 150px;
            right: 20px;
            width: 320px;
            height: 450px;
            background: white;
            border-radius: 15px;
            display: none;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 3600;
            overflow: hidden;
        }
        .ai-header { background: var(--primary); color: white; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; }
        .ai-messages { flex: 1; padding: 15px; overflow-y: auto; background: #f9f9f9; font-size: 13px; }
        .ai-input { display: flex; padding: 10px; border-top: 1px solid #eee; }
        .ai-input input { flex: 1; border: 1px solid #ddd; padding: 8px; border-radius: 20px; outline: none; }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* Flag Menu Styling */
        .flag-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            padding: 10px;
        }

        .product-card:hover { transform: scale(1.02); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
    <div class="sidebar" id="sidebar">
        <div style="background: var(--amazon-blue); color: white; padding: 25px;">
            <i class="fas fa-user-circle" style="font-size: 40px;"></i>
            <h3 style="margin: 10px 0 5px;">Hello, Sign In</h3>
            <p style="font-size: 12px; opacity: 0.8;">Enjoy global shopping with Oshan Cart</p>
        </div>
        <div style="padding: 15px;">
            <h4 style="color: var(--primary);">Shop By Category</h4>
            <a href="#" onclick="filterCat('Womens')" style="display:block; padding:12px 0; text-decoration:none; color:#333; border-bottom:1px solid #eee;"><i class="fas fa-female"></i> Womens Fashion</a>
            <a href="#" onclick="filterCat('Mens')" style="display:block; padding:12px 0; text-decoration:none; color:#333; border-bottom:1px solid #eee;"><i class="fas fa-male"></i> Mens Fashion</a>
            <a href="#" onclick="filterCat('Phones')" style="display:block; padding:12px 0; text-decoration:none; color:#333; border-bottom:1px solid #eee;"><i class="fas fa-mobile-alt"></i> Phones & Accessories</a>
            <a href="#" onclick="filterCat('Electronics')" style="display:block; padding:12px 0; text-decoration:none; color:#333; border-bottom:1px solid #eee;"><i class="fas fa-laptop"></i> Electronics</a>
            <a href="#" onclick="filterCat('Vehicles')" style="display:block; padding:12px 0; text-decoration:none; color:#333; border-bottom:1px solid #eee;"><i class="fas fa-car"></i> Vehicles & Parts</a>
            </div>
        <div style="padding: 15px; border-top: 5px solid #eee;">
            <h4>Settings & Support</h4>
            <a href="profile.html" style="display:block; padding:12px 0; text-decoration:none; color:#333;">My Account</a>
            <a href="orders.html" style="display:block; padding:12px 0; text-decoration:none; color:#333;">My Orders</a>
            <a href="#" onclick="accessAdminPanel()" style="display:block; padding:12px 0; text-decoration:none; color:#333;">Admin Dashboard</a>
            <a href="#" onclick="openCustomerService()" style="display:block; padding:12px 0; text-decoration:none; color:#333;">Customer Service</a>
        </div>
    </div>

    <nav class="desktop-only">
        <a href="index.html" class="logo">Oshan<span>Cart</span></a>
        
        <div class="search-container">
            <div class="cat-dropdown">
                <button class="cat-btn">All <i class="fas fa-caret-down"></i></button>
                <div class="dropdown-content" style="left:0; min-width: 200px;">
                    <a href="#" onclick="filterCat('All')">All Categories</a>
                    <a href="#" onclick="filterCat('Phones')">Phones üì±</a>
                    <a href="#" onclick="filterCat('Electronics')">Electronics üíª</a>
                    <a href="#" onclick="filterCat('Womens')">Womens Fashion üëó</a>
                    <a href="#" onclick="filterCat('Mens')">Mens Fashion üëï</a>
                    <a href="#" onclick="filterCat('Vehicles')">Vehicles üöó</a>
                    <a href="#" onclick="filterCat('Jewelry')">Jewelry üíç</a>
                    <a href="#" onclick="filterCat('Furniture')">Furniture üõãÔ∏è</a>
                </div>
            </div>
            <div class="search-bar">
                <input type="text" id="searchInputDesktop" placeholder="Search for products, brands and shops">
                <button class="search-submit" onclick="searchProducts()"><i class="fas fa-search"></i></button>
            </div>
        </div>

        <div class="nav-right">
            <div class="dropdown">
                <span class="fi fi-us"></span> EN <i class="fas fa-caret-down"></i>
                <div class="dropdown-content flag-grid">
                    <a href="#" onclick="changeLang('en','us')"><span class="fi fi-us"></span> USA</a>
                    <a href="#" onclick="changeLang('si','lk')"><span class="fi fi-lk"></span> SL</a>
                    <a href="#" onclick="changeLang('ja','jp')"><span class="fi fi-jp"></span> JP</a>
                    <a href="#" onclick="changeLang('en','ca')"><span class="fi fi-ca"></span> CA</a>
                    <a href="#" onclick="changeLang('en','au')"><span class="fi fi-au"></span> AU</a>
                </div>
            </div>

            <div class="dropdown">
                <span>Hello, Sign In</span>
                <b>Account & Lists <i class="fas fa-caret-down"></i></b>
                <div class="dropdown-content">
                    <a href="profile.html">‚úçÔ∏è My Profile</a>
                    <a href="orders.html">üéÅ My Orders</a>
                    <a href="referral.html">ü§ù Referral Program</a>
                    <a href="affiliate.html">üë• Affiliate Program</a>
                    <hr>
                    <a href="#" onclick="accessAdminPanel()">üë§ Admin Dashboard</a>
                    <a href="become-seller.html">üë®‚Äçüåæ Become a Seller</a>
                    <a href="seller-dashboard.html">üìä Seller Dashboard</a>
                </div>
            </div>

            <a href="cart.html" style="color:white; text-decoration:none;">
                <i class="fas fa-shopping-cart" style="font-size:20px;"></i> <b>Cart</b>
            </a>
        </div>
    </nav>

    <div class="mobile-header mobile-only">
        <i class="fas fa-bars" style="color:white; font-size:22px; cursor:pointer;" onclick="toggleSidebar()"></i>
        <div class="mobile-search-box">
            <i class="fas fa-search" style="color:#777;"></i>
            <input type="text" id="searchInputMobile" placeholder="Search Oshan Cart...">
        </div>
        <i class="fas fa-camera" style="color:white; font-size:20px;"></i>
    </div>

    <div class="container" style="padding-bottom: 80px;">
        <div class="product-grid" id="productDisplay">
            </div>
    </div>

    <div class="bottom-nav mobile-only">
        <a href="index.html" class="bottom-nav-item active"><i class="fas fa-home"></i>Home</a>
        <a href="#" onclick="toggleSidebar()" class="bottom-nav-item"><i class="fas fa-th-large"></i>Categories</a>
        <a href="cart.html" class="bottom-nav-item"><i class="fas fa-shopping-cart"></i>Cart</a>
        <a href="profile.html" class="bottom-nav-item"><i class="fas fa-user"></i>Account</a>
    </div>

    <div class="ai-btn" onclick="toggleChat()"><i class="fas fa-robot"></i></div>
    <div class="ai-chat-box" id="aiChatBox">
        <div class="ai-header">
            <span>Oshan AI Assistant</span>
            <i class="fas fa-times" onclick="toggleChat()" style="cursor:pointer;"></i>
        </div>
        <div class="ai-messages" id="aiMessages">
            <div style="background:#eee; padding:10px; border-radius:10px; margin-bottom:10px;">Hello! I am Oshan AI. How can I help you today?</div>
        </div>
        <div class="ai-input">
            <input type="text" id="aiInput" placeholder="Type message...">
            <button onclick="sendAiMessage()" style="border:none; background:none; color:var(--primary); font-size:20px; margin-left:10px;"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDy430AP0t92QND_VdaoCkK0J23y2c5rkE",
            authDomain: "oshancart.firebaseapp.com",
            projectId: "oshancart",
            storageBucket: "oshancart.appspot.com",
            messagingSenderId: "686982543488",
            appId: "1:686982543488:web:d74a83a3f53dbae3754e65"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        let allProducts = [];

        // REAL-TIME PRODUCT FETCH
        const q = query(collection(db, "products"), orderBy("timestamp", "desc"));
        onSnapshot(q, (snapshot) => {
            allProducts = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            displayItems(allProducts);
        });

        window.displayItems = (items) => {
            const grid = document.getElementById('productDisplay');
            grid.innerHTML = items.map(item => `
                <div class="product-card" style="background:white; border-radius:10px; padding:10px; position:relative;">
                    <img src="${item.image}" style="width:100%; height:160px; object-fit:contain; border-radius:8px;" onclick="viewProduct('${item.id}')">
                    <h4 style="font-size:13px; margin:10px 0; height:35px; overflow:hidden;">${item.name}</h4>
                    <p style="color:var(--primary); font-weight:bold; font-size:16px; margin:0;">Rs. ${item.price.toLocaleString()}</p>
                    <button onclick="buyNow('${item.id}')" style="width:100%; background:var(--orange); border:none; padding:8px; border-radius:5px; margin-top:10px; font-weight:bold; cursor:pointer;">Buy Now</button>
                </div>
            `).join('');
        };

        window.viewProduct = (id) => { window.location.href = `product-details.html?id=${id}`; };
        window.buyNow = (id) => { window.location.href = `checkout.html?id=${id}`; };
    </script>

    <script>
        // NAVIGATION & SIDEBAR LOGIC
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
            const overlay = document.getElementById('sidebarOverlay');
            overlay.style.display = overlay.style.display === 'block' ? 'none' : 'block';
        }

        function accessAdminPanel() {
            let pw = prompt("Enter Admin Password:");
            if(pw === "Lakshan@2001") {
                window.location.href = "admin-dashboard.html";
            } else { alert("Wrong Password!"); }
        }

        // AI CHAT LOGIC
        function toggleChat() {
            const chat = document.getElementById('aiChatBox');
            chat.style.display = chat.style.display === 'flex' ? 'none' : 'flex';
        }

        async function sendAiMessage() {
            const input = document.getElementById('aiInput');
            const msg = input.value;
            if(!msg) return;

            const container = document.getElementById('aiMessages');
            container.innerHTML += `<div style="text-align:right; background:var(--soft-pink); padding:10px; border-radius:10px; margin-bottom:10px; margin-left:40px;">${msg}</div>`;
            input.value = '';

            // Simple AI Logic (You can connect this to OpenAI/Gemini API later)
            setTimeout(() => {
                let response = "I'm checking that for you on Oshan Cart...";
                if(msg.toLowerCase().includes("hello")) response = "Hello! How can Oshan AI assist you today?";
                if(msg.toLowerCase().includes("order")) response = "You can track your orders in the 'My Orders' section of your account.";
                
                container.innerHTML += `<div style="background:#eee; padding:10px; border-radius:10px; margin-bottom:10px; margin-right:40px;">${response}</div>`;
                container.scrollTop = container.scrollHeight;
            }, 1000);
        }

        function changeLang(lang, country) {
            alert("Switching language to " + lang.toUpperCase() + "...");
            // Language logic implementation
        }

        function openCustomerService() {
            window.open("https://wa.me/94727600501", "_blank");
        }
    </script>
</body>
</html>
